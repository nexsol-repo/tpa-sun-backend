= TPA Sun Backend API 문서
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectlinks:
// 스니펫 경로 변수 설정
:snippets: build/generated-snippets

== 소개
TPA Sun Backend API 문서입니다.

== 인증 (Auth)

=== 로그인
// [변경] operation:: 매크로 대신 수동 include 사용
==== 요청
include::{snippets}/auth-login/http-request.adoc[]
include::{snippets}/auth-login/request-fields.adoc[]

==== 응답
include::{snippets}/auth-login/http-response.adoc[]
include::{snippets}/auth-login/response-fields.adoc[]

=== 이메일 인증 코드 발송
회원가입 또는 로그인을 위해 이메일로 인증 코드를 발송합니다.

==== 요청
include::{snippets}/auth-email-send/http-request.adoc[]
include::{snippets}/auth-email-send/request-fields.adoc[]

==== 응답
include::{snippets}/auth-email-send/http-response.adoc[]
include::{snippets}/auth-email-send/response-fields.adoc[]


=== 이메일 인증 코드 검증
수신한 이메일 인증 코드가 유효한지 검증합니다.

==== 요청
include::{snippets}/auth-email-verify/http-request.adoc[]
include::{snippets}/auth-email-verify/request-fields.adoc[]

==== 응답
include::{snippets}/auth-email-verify/http-response.adoc[]
include::{snippets}/auth-email-verify/response-fields.adoc[]

== 유저 (User)

=== 회원가입
==== 요청
include::{snippets}/user-signup/http-request.adoc[]
include::{snippets}/user-signup/request-fields.adoc[]

==== 응답
include::{snippets}/user-signup/http-response.adoc[]
include::{snippets}/user-signup/response-fields.adoc[]

=== 내 정보 조회
로그인된 사용자의 정보를 조회합니다.

==== 요청
include::{snippets}/user-me/http-request.adoc[]
include::{snippets}/user-me/request-headers.adoc[]

==== 응답
include::{snippets}/user-me/http-response.adoc[]
include::{snippets}/user-me/response-fields.adoc[]

=== 내 정보 수정
로그인된 사용자의 정보를 수정합니다.
이메일 등 변경된 정보만 전송하면 부분 업데이트(PATCH)가 수행됩니다.

==== 요청
include::{snippets}/user-update/http-request.adoc[]
include::{snippets}/user-update/request-headers.adoc[]
include::{snippets}/user-update/request-fields.adoc[]

==== 응답
include::{snippets}/user-update/http-response.adoc[]
include::{snippets}/user-update/response-fields.adoc[]

== 시스템 (System)

=== 헬스 체크
서버 상태를 확인합니다.

==== 요청
include::{snippets}/health-check/http-request.adoc[]

==== 응답
include::{snippets}/health-check/http-response.adoc[]


== 파일 (File)

=== 보험 증빙 서류 업로드 (PDF)
보험 가입에 필요한 증빙 서류(사업자등록증, 발전사업허가증 등)를 업로드합니다.
PDF 파일만 허용되며, 업로드 후 반환된 `key`를 사용하여 보험 가입 조건 저장 API를 호출해야 합니다.

==== 요청
include::{snippets}/files-upload-insurance/http-request.adoc[]
include::{snippets}/files-upload-insurance/request-parts.adoc[]

==== 응답
include::{snippets}/files-upload-insurance/http-response.adoc[]
include::{snippets}/files-upload-insurance/response-fields.adoc[]

=== 사고접수 업로드
현장사진,수리비견젹서,화재증명원,진료비 납입내역서 첨부 파일 업로드


==== 요청
include::{snippets}/files-upload-accident/http-request.adoc[]
include::{snippets}/files-upload-accident/request-parts.adoc[]

==== 응답
include::{snippets}/files-upload-accident/http-response.adoc[]
include::{snippets}/files-upload-accident/response-fields.adoc[]

=== 전자 서명 이미지 업로드
청약서 서명을 위한 이미지 파일을 업로드합니다.
이미지 파일(PNG, JPG 등)만 허용됩니다.

==== 요청
include::{snippets}/files-upload-signature/http-request.adoc[]
include::{snippets}/files-upload-signature/request-parts.adoc[]

==== 응답
include::{snippets}/files-upload-signature/http-response.adoc[]
include::{snippets}/files-upload-signature/response-fields.adoc[]

=== 파일 삭제
업로드된 파일을 스토리지에서 즉시 삭제합니다. (업로드 취소 시 사용)

==== 요청
include::{snippets}/files-delete/http-request.adoc[]
include::{snippets}/files-delete/query-parameters.adoc[]

==== 응답
include::{snippets}/files-delete/http-response.adoc[]
include::{snippets}/files-delete/response-fields.adoc[]

== 보험 (Insurance)

=== 1. 청약 시작 (약관 동의)
신규 보험 가입 프로세스를 시작합니다. 약관 동의 내역을 저장하고 새로운 청약서 ID를 발급받습니다.

==== 요청
include::{snippets}/insurance-start/http-request.adoc[]
include::{snippets}/insurance-start/request-fields.adoc[]

==== 응답
include::{snippets}/insurance-start/http-response.adoc[]
include::{snippets}/insurance-start/response-fields.adoc[]

=== 2. 발전소 정보 저장 (임시저장)
발전소 정보를 저장합니다. 임시저장이 가능하므로 필수 값이 누락되어도 저장됩니다.

==== 요청
include::{snippets}/insurance-save-plant/http-request.adoc[]
include::{snippets}/insurance-save-plant/path-parameters.adoc[]
include::{snippets}/insurance-save-plant/request-fields.adoc[]

==== 응답
include::{snippets}/insurance-save-plant/http-response.adoc[]
include::{snippets}/insurance-save-plant/response-fields.adoc[]

=== 3. 가입 조건 저장 (심사/계산)
가입 조건 및 질권 정보를 저장합니다. 저장 시점에 자동으로 보험료가 산출되며, 심사 대상(조건2)일 경우 에러가 발생할 수 있습니다.

==== 요청
include::{snippets}/insurance-save-condition/http-request.adoc[]
include::{snippets}/insurance-save-condition/path-parameters.adoc[]
include::{snippets}/insurance-save-condition/request-fields.adoc[]

==== 응답
include::{snippets}/insurance-save-condition/http-response.adoc[]
include::{snippets}/insurance-save-condition/response-fields.adoc[]

=== 4. 최종 가입 완료
작성된 청약서를 최종 승인하고 가입 완료 상태로 변경합니다. 필수 정보가 모두 입력되어 있어야 합니다.

==== 요청
include::{snippets}/insurance-complete/http-request.adoc[]
include::{snippets}/insurance-complete/path-parameters.adoc[]

==== 응답
include::{snippets}/insurance-complete/http-response.adoc[]
include::{snippets}/insurance-complete/response-fields.adoc[]

=== 청약서 상세 조회 (이어하기)
작성 중이거나 완료된 청약서의 전체 정보를 조회합니다. (이어하기 기능)

==== 요청
include::{snippets}/insurance-get/http-request.adoc[]
include::{snippets}/insurance-get/path-parameters.adoc[]

==== 응답
include::{snippets}/insurance-get/http-response.adoc[]
include::{snippets}/insurance-get/response-fields.adoc[]

=== 보험 가입 리스트
나의 보험 가입내역을 조회합니다.

=== 요청
include::{snippets}/insurance-my-list/http-request.adoc[]
include::{snippets}/insurance-my-list/query-parameters.adoc[]
include::{snippets}/insurance-my-list/request-headers.adoc[]

=== 응답
include::{snippets}/insurance-my-list/http-response.adoc[]
include::{snippets}/insurance-my-list/response-fields.adoc[]

=== 사고 접수용 가입 완료 발전소 목록 조회
사고 접수 시 선택 가능한(가입 완료된) 발전소 목록을 조회합니다. (Select Box 용)

==== 요청
include::{snippets}/insurance-options-completed/http-request.adoc[]
include::{snippets}/insurance-options-completed/request-headers.adoc[]

==== 응답
include::{snippets}/insurance-options-completed/http-response.adoc[]
include::{snippets}/insurance-options-completed/response-fields.adoc[]

== 사고 (Accident)

=== 신규 사고 접수
가입된 보험에 대해 사고를 접수합니다.

==== 요청
include::{snippets}/accident-report/http-request.adoc[]
include::{snippets}/accident-report/request-headers.adoc[]
include::{snippets}/accident-report/request-fields.adoc[]

==== 응답
include::{snippets}/accident-report/http-response.adoc[]
include::{snippets}/accident-report/response-fields.adoc[]