# 시스템 요구사항 정의서 (System Requirements Specification)

## 1. 개요 (Overview)
본 문서는 태양광 발전소 종합공제(보험) 플랫폼의 기능적 요구사항을 정의합니다.
시스템의 구체적인 데이터 구조와 정책은 다음 문서를 기준으로 구현합니다.

* **데이터 구조 및 스키마:** [`DOMAIN_MODEL.md`](DOMAIN_MODEL.md) 참조
* **비즈니스 로직 및 정책:** [`BUSINESS_POLICY.md`](BUSINESS_POLICY.md) 참조

---

## 2. 회원 및 인증 (Authentication)

### 2.1. 로그인 (Login)
* **방식:** 사업자등록번호(ID) + 이메일 주소를 이용한 인증 로그인 (Passwordless).
* **로직:**
    1. 사용자가 사업자등록번호 입력.
    2. 해당 사업자번호에 연동된 이메일 계정이 있는지 확인.
    3. 이메일로 인증 링크 또는 코드 발송 후 인증 완료 시 로그인 처리.
* **참고:** 동일 사업자번호 하위에 부서/담당자별로 다른 이메일을 가진 N개의 계정이 존재할 수 있음.

### 2.2. 이메일 찾기 (Find Email)
* **기능:** 사업자번호를 입력하여 가입된 이메일 목록을 확인하고 로그인 진행.
* **프로세스:**
    1. 사업자번호 입력.
    2. 마스킹된 이메일 리스트 노출 (예: `ab***@company.com`).
    3. 본인 이메일 선택 후 인증 메일 발송 요청.

### 2.3. 회원가입 (Sign Up)
* **대상:** 신규 사업자 또는 기존 사업자의 새로운 담당자.
* **입력 정보:**
    * **사업자 정보:** 사업자번호, 상호(법인명), 대표자명, 대표자 휴대전화 (가입 후 수정 불가).
    * **신청자 정보:** 신청자명, 휴대전화, 이메일 (대표자 정보와 동일 선택 가능).
* **동의:** 서비스 이용약관, 개인정보 처리방침 필수 동의.

---

## 3. 보험 신규 가입 (New Subscription)
가입 프로세스는 단계별 **임시저장** 기능을 제공해야 합니다.

### [Step 1] 약관 동의
* 필수 동의 항목(정보 제공 동의, 개인정보 수집 동의) 체크 후 진행.

### [Step 2] 발전소 정보 입력
* **사업자/신청자 정보:** 로그인된 계정 정보( `/me` )를 불러와 자동 기입 (수정 불가/가능 여부 정책 확인).
* **발전소 상세 정보 입력:**
    * 발전소명, 주소 (주소 선택 시 `지역` 자동 매핑).
    * 설비 용량(kW), 발전소 면적($m^2$).
    * 설비 형태(지붕형 여부 중요), 구동 방식, 전력 판매처.
    * 사용 전 검사일.
    * *데이터 참조:* `DOMAIN_MODEL.md` > **2. 발전소**

### [Step 3] 가입 조건 확인 및 담보 설정
이 단계에서 **가입 불가 조건(Reject Condition)** 을 체크합니다.

#### 3.1. 핵심 가입 정보
* **필수 입력:** ESS 설치 여부, 재물손해(MD) 가입금액, 배상책임(GL) 가입금액.
* **정책 체크:** [`BUSINESS_POLICY.md`](BUSINESS_POLICY.md) > **2.1 가입 불가 조건** 참조.
    * 조건 미달 시(ESS 설치, 한도 초과 등): "담당자 별도 문의" 팝업 노출 후 프로세스 중단.
    * 조건 충족 시: 다음 항목 입력 활성화.

#### 3.2. 추가 정보 입력
* **기업휴지(BI) 설정:** 가입금액 입력 (선택 사항).
* **보험 기간:** 개시일 선택 (종료일은 자동 계산).
* **과거 사고 이력:** 최근 5년 사고 유무(Y/N).
    * Y 선택 시: 사고 일자, 지급 보험금, 사고 내용 입력.
* **질권 설정:** 질권 설정 유무(Y/N).
    * Y 선택 시: 은행명, 금액, 담당자 정보, 증권 송부 여부 등 입력.

#### 3.3. 서류 첨부
* **제약:** PDF 파일만 업로드 가능.
* **항목:** 사업자등록증(필수), 발전사업허가증(필수), 사용전검사 확인증 등.

### [Step 4] 보험료 확인
* **기능:** 입력된 정보를 바탕으로 실시간 보험료 산출 내역 표시.
* **표시 항목:**
    * 담보별 상세 내역 (MD, BI, GL 각각의 가입금액 및 자기부담금).
    * 산출 기준 확인 (적용된 요율, 지역, 면적, 설비 형태 계수 등).
    * **총 보험료 합계.**
* *로직 참조:* [`BUSINESS_POLICY.md`](BUSINESS_POLICY.md) > **3. 보험료 산출 로직**

### [Step 5] 청약 확인 및 서명
* 최종 청약 정보 확인 이미지/텍스트 표시.
* 전자 서명 후 가입 신청 완료.

---

## 4. 마이페이지 (My Page)

### 4.1. 정보 관리
* **사업자 정보:** 읽기 전용 (수정 불가).
* **신청자 정보:** 이름, 연락처 등 수정 가능.

### 4.2. 보험 가입 내역
* **목록(List):**
    * 페이징 처리 (기본 10개).
    * 컬럼별 정렬(Sorting) 기능 (발전소명, 상태, 결제일 등).
    * **상태 값:** 작성중, 심사중, 가입완료, 만기임박, 기간만료, 가입취소, 중도해지.
    * **기능:** 가입증명서 조회, 납입내역서 출력.
* **상세(Detail):**
    * 선택한 계약의 상세 담보 내용 및 발전소 정보 조회.

### 4.3. 사고 접수 내역
* **목록(List):**
    * 페이징 및 정렬 지원.
    * 주요 정보: 사고 일시, 사고 종류, 처리 상태(현장심사중, 지급완료 등).

---

## 5. 사고 접수 (Accident Reporting)

### 5.1. 신규 사고 접수
* **1단계 (계약 선택):** 본인이 가입한 발전소 리스트(Select Box) 중 사고 발생 발전소 선택.
    * 피보험자 및 연락처 자동 매핑.
* **2단계 (사고 상세):**
    * 사고 종류 (신체/재산/법적방어).
    * 사고 일시 및 장소.
    * 피해 물품 및 파손 정도, 추정 금액.
* **3단계 (증빙):** 현장 사진, 견적서, 화재증명원 등 파일 업로드.